<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Aura Station UI</title>
    <style>
        body { background: #000; color: #fff; font-family: Arial, sans-serif; margin: 0; overflow: hidden; }
        #gear-btn { position: fixed; top: 10px; right: 10px; background: rgba(0,234,255,0.1); border: 1px solid #00eaff; color: #00eaff; padding: 10px 15px; border-radius: 8px; font-weight: bold; z-index: 1000; }
        .top-section { display: flex; justify-content: space-between; height: 45vh; padding: 15px; position: relative; }
        
        .box-left { width: 35%; display: flex; flex-direction: column; align-items: flex-start; }
        #clock { font-size: 13vh; font-weight: bold; line-height: 1; }
        .status-bar { display: flex; align-items: center; gap: 10px; margin-top: 5px; }
        #date { font-size: 2.4vh; color: #00eaff; font-weight: bold; text-transform: uppercase; }
        
        /* ZENTRUM */
        .box-center { position: absolute; left: 50%; transform: translateX(-50%); width: 42%; display: flex; flex-direction: column; align-items: center; text-align: center; }
        .temp-row { display: flex; align-items: center; justify-content: center; }
        #current-icon { width: 16vh; height: 16vh; }
        #main-pop { font-size: 2.2vh; color: #00eaff; margin-left: 5px; font-weight: bold; }
        #temp-display { font-size: 18vh; font-weight: bold; line-height: 1; }
        #weather-desc { font-size: 3vh; font-weight: bold; text-transform: uppercase; margin: 5px 0; }
        #feels-like { font-size: 2.5vh; color: #00eaff; font-weight: bold; }
        #clothes { font-size: 3vh; color: #ffcc00; font-weight: bold; margin-top: 5px; }

        .box-right { width: 25%; text-align: right; padding-top: 20px; }
        .astro { font-size: 3vh; font-weight: bold; margin-bottom: 5px; }
        #moon { color: #00eaff; font-size: 2.6vh; margin-bottom: 15px; }
        .info-gray { color: #888; font-size: 1.6vh; line-height: 1.4; border-top: 1px solid #333; padding-top: 5px; }

        .ticker-wrap { width: 100%; height: 7vh; background: #111; border-top: 2px solid #333; overflow: hidden; white-space: nowrap; }
        #ticker { display: inline-block; padding-left: 100%; animation: t 60s linear infinite; font-size: 3.5vh; color: #00eaff; line-height: 7vh; font-weight: bold; }
        @keyframes t { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }

        table { width: 100%; height: 38vh; table-layout: fixed; border-collapse: collapse; }
        td { text-align: center; font-size: 2.8vh; font-weight: bold; }
        .t-icon { width: 6vh; height: 6vh; }

        /* MEN√ú */
        #menu-overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.98); flex-direction:column; align-items:center; z-index:2000; padding-top: 20px; }
        .menu-btn { background: #111; border: 1px solid #333; color: #fff; padding: 15px; margin: 5px; width: 90%; max-width: 500px; border-radius: 10px; font-size: 2.5vh; font-weight: bold; display: flex; justify-content: space-between; }
        .sub { display:none; width: 90%; max-width: 500px; text-align: center; }
        input { width: 100%; padding: 15px; background: #222; border: 1px solid #444; color: #fff; border-radius: 10px; margin: 10px 0; font-size: 2vh; }
    </style>
</head>
<body>
    <div id="gear-btn" onclick="openM()">‚öô SETUP</div>
    <div class="top-section">
        <div class="box-left">
            <div id="clock">--:--</div>
            <div class="status-bar">
                <div id="date">...</div>
                <div id="bat" style="display:none; color:#fff; font-size:2.2vh;">üîã<span id="bat-lv">--%</span></div>
                <div id="wifi" style="color:#00ff00;">üì∂</div>
            </div>
            <a href="https://code-werft.de" target="_blank"><img src="logo.png" style="width:200px; margin-top:10px;"></a>
        </div>
        <div class="box-center">
            <div id="city-title" style="color:#888; letter-spacing:2px;">--</div>
            <div class="temp-row">
                <img id="current-icon" src=""><div id="temp-display">--¬∞</div><span id="main-pop">üíß--%</span>
            </div>
            <div id="weather-desc">--</div>
            <div id="feels-like">--</div>
            <div id="clothes">--</div>
        </div>
        <div class="box-right">
            <div class="astro">‚òÄ <span id="sr">--:--</span></div>
            <div class="astro">‚òæ <span id="ss">--:--</span></div>
            <div id="moon">--</div>
            <div class="info-gray">
                <b>Web App Update:</b> Build V17.9<br>
                <b>Wetter Update:</b> <span id="up-d">--.--</span> | <span id="up-t">--:--</span>
            </div>
        </div>
    </div>
    <div class="ticker-wrap"><div id="ticker">LADE DATEN...</div></div>
    <table id="forecast"></table>

    <div id="menu-overlay">
        <div id="m-main" style="width:100%; display:flex; flex-direction:column; align-items:center;">
            <img src="logo.png" style="width:150px; margin-bottom:20px;">
            <div class="menu-btn" onclick="showS('s-cfg')">üìç STANDORT & TIMER <span>‚ùØ</span></div>
            <a href="https://www.paypal.com/cgi-bin/webscr?cmd=_donations&business=piratkarl@web.de&currency_code=EUR" target="_blank" class="menu-btn" style="text-decoration:none; color:#ffcc00; border-color:#ffcc00;">‚òï KAFFEE-SPENDE <span>‚ùØ</span></a>
            <div class="menu-btn" onclick="showS('s-help')">üìñ HILFE & TRICKS <span>‚ùØ</span></div>
            <div class="menu-btn" onclick="showS('s-con')">üìß KONTAKT & WEB <span>‚ùØ</span></div>
            <button onclick="closeM()" style="background:#333; color:#fff; border:none; padding:15px; border-radius:10px; margin-top:10px; width:90%; max-width:500px;">SCHLIESSEN</button>
        </div>
        <div id="s-cfg" class="sub">
            <h2 style="color:#00eaff;">STANDORT & TIMER</h2>
            <input type="text" id="city-in" placeholder="Stadt">
            <div style="display:flex; gap:10px;"><input type="time" id="ts"> <input type="time" id="te"></div>
            <button onclick="save()" style="background:#00eaff; border:none; padding:15px; width:100%; border-radius:10px; font-weight:bold;">SPEICHERN</button>
            <button onclick="showM()" style="background:#333; color:#fff; border:none; padding:10px; border-radius:10px; margin-top:10px; width:100%;">ZUR√úCK</button>
        </div>
        <div id="s-help" class="sub"><h2 style="color:#00eaff;">HILFE</h2><p>Updates erfolgen automatisch. Tippe im Schlafmodus zum Aufwachen.</p><button onclick="showM()">ZUR√úCK</button></div>
        <div id="s-con" class="sub"><h2 style="color:#00eaff;">KONTAKT</h2><a href="https://code-werft.de" style="color:#00eaff;">WWW.CODE-WERFT.DE</a><button onclick="showM()" style="margin-top:20px;">ZUR√úCK</button></div>
    </div>

    <script>
        var API = '518e81d874739701f08842c1a55f6588';
        var city = localStorage.getItem('city') || 'Braunschweig';
        function z(n){return (n<10?'0':'')+n;}

        function update() {
            var now = new Date();
            document.getElementById('clock').innerText = z(now.getHours())+':'+z(now.getMinutes());
            var d = ['So','Mo','Di','Mi','Do','Fr','Sa'], m = ['Januar','Februar','M√§rz','April','Mai','Juni','Juli','August','September','Oktober','November','Dezember'];
            document.getElementById('date').innerText = d[now.getDay()] + ". " + now.getDate() + ". " + m[now.getMonth()];
            
            var y=now.getFullYear(), mo=now.getMonth()+1, da=now.getDate(); if(mo<3){y--;mo+=12;}++mo;
            var jd = (365.25*y) + (30.6*mo) + da - 694039.09; jd/=29.53; var b=Math.round((jd-parseInt(jd))*8); if(b>=8)b=0;
            document.getElementById('moon').innerText = ["üåë NEUMOND","üåí SICHEL","üåì 1. VIERTEL","üåî ZUN. MOND","üåï VOLLMOND","üåñ ABN. MOND","üåó LETZTES V.","üåò SICHEL"][b];
        }

        function load() {
            var x = new XMLHttpRequest();
            x.open("GET", "https://api.openweathermap.org/data/2.5/weather?q="+city+"&appid="+API+"&units=metric&lang=de", true);
            x.onload = function() {
                var d = JSON.parse(x.responseText);
                document.getElementById('temp-display').innerText = Math.round(d.main.temp) + "¬∞";
                document.getElementById('feels-like').innerText = "GEF√úHLT " + Math.round(d.main.feels_like) + "¬∞";
                document.getElementById('weather-desc').innerText = d.weather[0].description.toUpperCase();
                document.getElementById('city-title').innerText = d.name.toUpperCase();
                document.getElementById('current-icon').src = d.weather[0].icon + ".gif";
                var r = new Date((d.sys.sunrise + d.timezone - 3600)*1000), s = new Date((d.sys.sunset + d.timezone - 3600)*1000);
                document.getElementById('sr').innerText = z(r.getHours())+":"+z(r.getMinutes());
                document.getElementById('ss').innerText = z(s.getHours())+":"+z(s.getMinutes());
                var n = new Date(); document.getElementById('up-d').innerText = z(n.getDate())+"."+z(n.getMonth()+1); document.getElementById('up-t').innerText = z(n.getHours())+":"+z(n.getMinutes());
                loadF(d.coord.lat, d.coord.lon, d.main.temp);
            };
            x.send();
        }

        function loadF(lat, lon, ct) {
            var x = new XMLHttpRequest();
            x.open("GET", "https://api.openweathermap.org/data/2.5/forecast?lat="+lat+"&lon="+lon+"&appid="+API+"&units=metric&lang=de", true);
            x.onload = function() {
                var d = JSON.parse(x.responseText);
                var rN = Math.round(d.list[0].pop * 100);
                document.getElementById('main-pop').innerText = "üíß"+rN+"%";
                document.getElementById('clothes').innerText = rN > 30 ? "üåÇ REGENSCHIRM" : (ct < 5 ? "üß• WINTERJACKE" : (ct < 15 ? "üß• √úBERGANGSJACKE" : "üëï T-SHIRT"));
                var h = "<tr>", dy = "<tr>";
                for(var i=0; i<4; i++) {
                    var it = d.list[i], t = new Date(it.dt*1000);
                    h += "<td>"+t.getHours()+" Uhr<br><img class='t-icon' src='"+it.weather[0].icon+".gif'><br>"+Math.round(it.main.temp)+"¬∞</td>";
                }
                for(var i=0; i<32; i+=8) {
                    var it = d.list[i], day = new Date(it.dt*1000).toLocaleDateString('de-DE',{weekday:'short'}).toUpperCase();
                    dy += "<td>"+day.substr(0,2)+"<br><img class='t-icon' src='"+it.weather[0].icon+".gif'><br><span style='color:#ff4444'>"+Math.round(it.main.temp_max)+"¬∞</span> <span style='color:#00eaff'>"+Math.round(it.main.temp_min-2)+"¬∞</span></td>";
                }
                document.getElementById('forecast').innerHTML = h + "</tr>" + dy + "</tr>";
                var w = ["New York","Sydney","Tokyo","London"]; var tickerText = d.list[0].weather[0].description.toUpperCase();
                document.getElementById('ticker').innerText = tickerText + " +++ WELTWETTER L√ÑDT...";
                // Weltwetter-Logik hier einf√ºgen...
            };
            x.send();
        }

        function openM() { document.getElementById('menu-overlay').style.display='flex'; showM(); }
        function closeM() { document.getElementById('menu-overlay').style.display='none'; }
        function showM() { document.getElementById('m-main').style.display='flex'; var s=document.getElementsByClassName('sub'); for(var i=0; i<s.length; i++) s[i].style.display='none'; }
        function showS(id) { document.getElementById('m-main').style.display='none'; document.getElementById(id).style.display='block'; }
        function save() { localStorage.setItem('city', document.getElementById('city-in').value); localStorage.setItem('sleepStart', document.getElementById('ts').value); localStorage.setItem('sleepEnd', document.getElementById('te').value); location.reload(); }

        if(navigator.getBattery) navigator.getBattery().then(function(b){ 
            var f = function(){ document.getElementById('bat').style.display='block'; document.getElementById('bat-lv').innerText=Math.round(b.level*100)+"%"; };
            f(); b.onlevelchange=f;
        });
        update(); setInterval(update, 1000); load(); setInterval(load, 600000);
    </script>
</body>
</html>
